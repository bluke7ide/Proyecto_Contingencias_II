---
title: "Proyecto - Contingencias de Vida II"
author: 
  - Luis Fernando Amey Apuy - C20470
  - Javier Hernández Navarro - C13674
  - Anthony Mauricio Jiménez Navarro - C24067
  - Gustavo Alberto Amador Fonseca - C20459
date: "`r Sys.Date()`"
output:
  rmdformats::robobook:
    self_contained: true
    highlight: tango
---

# Librerías
```{r}
source("cod/setup.R")
```

Esto intenta realizar las fuerzas de transición de empeorarse
```{r}
mucar <- function(x, p1, p2, p3, p4, p5, p6){
  if(x <=65){
    return((p1+p2*p3^x)/(1+p4*p3^x+p5*p3^(-x))+p6)
  } else {
    v <- x - 65
    return(p1*v^5 + p2*v^4 + p3*v^3 + p4*v^2 + p5*v + p6)
  }
}
```

Lee el excel, hecho a mano 
```{r}
readdata <- function(sheet){
  data <- read_excel("data/DataPaper.xlsx", sheet = sheet)
  data <- sapply(data, as.double)
  colnames(data)[1] <- "x"
  data[is.na(data)] <- 0
  lista <- list(Able = data.frame(data[2:8,]),
                Mild = data.frame(data[10:16,]),
                Moderate = data.frame(data[18:24,]),
                Severe = data.frame(data[26:32,]),
                Profound = data.frame(data[34:40,]))
  return(lista)
}
```

```{r, warning=FALSE, message=FALSE}
MaleProb <- readdata("MaleProb")
FemaleProb <- readdata("FemaleProb")
MaleMu <- readdata("MaleMu")
FemaleMu <- readdata("FemaleMu")
```

Intenta practicar con las probabilidades para poder interpolarlas
```{r}
piv <- MaleProb[["Able"]]
piv[8,] <- c(119, 0, 0, 0, 0, 0, 1)
modelo <- data.frame(x = 20:119)
modelo <- left_join(modelo, piv, by = "x")

modelo[1:61, 2] <- as.double(spline(piv[1:7, 1], piv[1:7, 2], xout = 20:80)$y)
modelo[61:99, 2] <- as.double(spline(piv[6:8, 1], piv[6:8, 2], xout = 80:118)$y)
plot(modelo$Able)
```
Not convinced















